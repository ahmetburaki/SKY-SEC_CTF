from Crypto.Util.number import *
from gmpy2 import iroot

A = 22226348651790136410272914141976884416317736286145659467747519189357932228897499152787772306249522389373814646727130628932054351435785941273294151706776056224421017228693488698884056711356989973160227951953266619910840728440778354358746918274450834409284006211384668721189198745228282783609448386376335016391545246715073235504035439163574474629663492037559202286612697293034020550623703703277811575496908478137576226780355728414994559148744285369204455182595897115017197520417268651939276192889591534171943097417241063995540576619890996524189110093971996516824870611971018785418252350991361812635244126570125376153557
B = 5314099466232940848715102854150567193846511159478024750333332682064080094168478130569282278965510383907190079901933182880155615598713931184315557228279927927931735763174057325781467336865589556256570875829077514726495804605597026428841426328325096430746224665429424844191567563861928043784680018522241067039655902314700282148538873455066453277322044782082027282683352248343386984021375677694647661423463170995284854798177493626390374946914594611944231116209025434665021536418469587526044884414729357156498338067455825239320551369810061088368244503477568899863687661719899112073213586437267436883418472076371771654392248001300463855853191846488970012178187710947097623616132148909377156845562850111479784748423871262213967485740838069222512026187943062443006329313929279834557573405674248261368451771340780933587621373698760097641031216085533146828734524325086431133089951738207752193008661517016485483931050031559896972001423119076581009693914449396529413423095755288287568997006063212460229902493613674552300001390706142694052170547263412866542549869431034149401005624690352893273611280906507226022393265153752856707359865945251633664027069068014646300619858820491720290798984243521435513639565830813487275535479162939493646840828994906538044721304448031372471025732622198143981263014869757530400631846420886695534484010763360645326949748013497262663240483911474654767739594101262167154798158455267306638193647765454072555210553728440540349359825504553904421923129451833184324963846875082060364651636035960047665150805095142850194397822090110287556006597209174781491598383347493847540762814354254149253364827939642361916273212340314135391729242946351494743201853555623410306141285731133500521373910016723451158754535085459963118143722581853649156469130604154555999705106721381047969302750291790853839153698703287091719169154029385863452261535621913
x_y = 300607067574034768532731112961272852708310897029563521121134519325803952776449484836432858827818971294117066201366930606489912383390987790757092618694080707723936395143252899861848388884367544232597687967926576518038913612061659270646628835267456882153511175224733941616196032554420565946262155593845617606358
c1 = 7386765433602524353882959335224047959336665475708437784680148313290410186677043641202178143086348038616213062870321882375297692748201894184456943836826160501616454177342442179672765699122585241105283646906629213125193341957215793382728643002739131833812686027520878456431342770355061485299058429525991558787348124396671788524940473668653376925080982670355698124222894947125624968017413672077547877557221845473371807454147006178501488467645215569130802218655124351754935062282579999892967956809430535875471807866195338488341065286900802545598925480755674066165176000799471774674364832719998039170043970142547244966449
c2 = 466061222777161481424399679096633291259706525400592081416912581320613610447433261567889997661049349880796959771878126752240265999250791290820967936307123128518443187893579533206944832609945841457475023105769816142698241692241674089839101569070742581640081030891636331532907459956903887845445111167264614731725647168450300909176465824268442068604100999412036621080335710995456103983992202321316913198484868549593553243802843320466265703425532117402920169620848902463133698998571368175781254454314800620018299835931559063279876645929196263407465802690081714144570171543852684994154855063627176789516659748972710818561274876507830549327974690537009090408107464248115336395878827462886039269433780041057141063738814351486538723280436575507215549257452110008656644220243193205159094228279828976520304746042242015397104720339172728148847790728773284773117481748199801446986877986625298238675600487396083819058370709632958608135071446050013021998063970350607160165349118875376690618571988703496710985546296322662899413376860367597676194568265324667019665804148168422269250245821678435165935948175154338363202444193846132879079810022215050663877437465946693480829426680039202295780585257149986400158209382992474323032638336706021883480444703268181365573845989803135110797265785940641627034118376189685734388058554335079922985147049178267457692695449350727656825530497984098751186158824404509580681985289135673773450478416597632080391153961714180724156771506679214176998428209719063843039810170088217676139630527208447227713032746636194490242537633148155981742600185324038071873710026487644381831200691802621924226270947450702871299319403506146425104877575847251046105154070255319508532396787303693363772421332338707452755512485822167130974250695899249074598356199057659663009738573476332519935209779304250509115155067853114249019524965746335370941183209740
l_g = 8354917972535949851732922161659314679112837296679996072595087045421941850641485310828379663855737527728856134444760976667226710195708049223676094931401789157654155499489145104209229587288450731904473663516112624993346422732012177311958271435594730171841631657439530652147489709609402665558915409367735896665925186224971732646040685912620821527560108753291695995876620861251492563052285344830398084442369473755477792124358817539405376279638642851283529507688353594779986031716619931574318122633530040011861503124075833148616748192488883779500549869967464120470106158099875033281434036280416548549707393547523321987472343756470735407537491246990493387705001450336219134744322871759872186514268

e2 = 65537

# Flag'in 2. kısmı

# B = z**3 olduğu için B değerinin 3. dereceden kökü alınarak z değeri bulunur.

z = iroot(B, 3)[0]

# Euler's totient formula kullanılarak phi değeri hesaplanır.

phi2 = (z**2) * (z-1)

d2 = pow(e2, -1, phi2)

m2 = pow(c2, d2, B)

print(long_to_bytes(m2))

# Flag'in 1. kısmı

# e değerini bulmak için: (((C * A) + (2 * k)) % A) // 2 = k

e1 = (l_g % A) // 2

# phi değerini bulmak için: (p-1) * (q-1) = (p*q) - (p+q) + 1 = n - (p+q) + 1

phi1 = A - (x_y) + 1

d1 = pow(e1, -1, phi1)

m1 = pow(c1, d1, A)

print(long_to_bytes(m1))

# Flag: SKYSEC{s4d3c3_b1r4z_m4tem4T1k_g3R1s1_k0l4y_z4t3n_d1m1_AB1_<3}